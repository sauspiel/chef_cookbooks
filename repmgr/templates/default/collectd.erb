LoadPlugin "postgresql"

<Plugin postgresql>
  <Query replication_lag>
  Statement "SELECT EXTRACT(EPOCH FROM time_lag) as time_lag FROM repmgr_<%= @config[:cluster] %>.repl_status where standby_node = <%= @config[:node] %>"
    <Result>
      Type gauge
      InstancePrefix "replication_time_lag"
      ValuesFrom time_lag
    </Result>
  </Query>

  <Database "<%= @config[:dbname] %>">
    Host "<%= @config[:host] %>"
    User "<%= @config[:user] %>"
    Query replication_lag
  </Database>
</Plugin>
