; generated by chef for <%= node[:fqdn] %>

[barman]

; Main directory
barman_home = <%= node[:barman][:home] %>

; Log location
log_file = <%= @logfile %>

; Default compression level: possible values are None (default), bzip2, gzip or custom
compression = <%= node[:barman][:compression] %>

; Pre/post backup hook scripts
;pre_backup_script = env | grep ^BARMAN
;post_backup_script = env | grep ^BARMAN

<% node[:barman][:hooks][:global].each do |hook, value| %>
<%= hook %> = <%= value %>
<% end %>

<% @servers.each do |srv| %>
[<%= srv[:id] %>] 
description = "<%="#{srv[:id]} PostgreSQL Master Server @ #{srv[:name]}" %>"
ssh_command = ssh postgres@<%= srv[:ssh_master_address] %>
conninfo = host=<%= srv[:pg_master_address] %> user=postgres port=<%= srv[:pg_master_port] %>
<% if srv[:bandwidth_limit] %>
bandwidth_limit = <%= srv[:bandwidth_limit] %>
<% end -%>

<% end -%>




